<?xml version="1.0" encoding="utf-8"?>
<!--
'*	005_balloon.xml
'*	Copyright (c) Websoft, 2006.  All rights reserved.
-->
<params>
	<object>
		<label>Idea Balloon</label>
		<width>250</width>
		<height>140</height>
		<description>Idea Balloon - with rounded corners, color border and bubble-like arrow</description>
	</object>
	<page name="Parameters" w="240" h="150">
		<param type="label" id="" text="Text:" def="" x="10" y="10" w="100" h="13"/>
		<param type="textedit" id="balloon_text" text="" def="Default text" x="110" y="9" w="103" h="13"/>
		<param type="label" id="" text="Text margin:" def="" x="10" y="26" w="100" h="13"/>
		<param type="edit" id="balloon_margin" text="" def="12" x="110" y="25" w="18" h="13"/>
		<param type="label" id="" text="px" def="" x="130" y="26" w="40" h="13"/>
		<param type="label" text="Color scheme:" x="10" y="42" w="100" h="13"/>
		<param type="select" id="balloon_profile" text="" def="yellow_orange" x="110" y="41" w="120" h="13">
			<items>
				<item id="yellow_orange" label="yellow-orange">
					<events>
						<event name="selendok" target="lab_border_color_custom" action="disable"/>
						<event name="selendok" target="border_color_custom" action="disable"/>
						<event name="selendok" target="lab_bg_color_custom" action="disable"/>
						<event name="selendok" target="bg_color_custom" action="disable"/>
					</events>
				</item>
				<item id="lyellow_yellow" label="lightyellow-yellow">
					<events>
						<event name="selendok" target="lab_border_color_custom" action="disable"/>
						<event name="selendok" target="border_color_custom" action="disable"/>
						<event name="selendok" target="lab_bg_color_custom" action="disable"/>
						<event name="selendok" target="bg_color_custom" action="disable"/>
					</events>
				</item>
				<item id="lred_red" label="lightred-red">
					<events>
						<event name="selendok" target="lab_border_color_custom" action="disable"/>
						<event name="selendok" target="border_color_custom" action="disable"/>
						<event name="selendok" target="lab_bg_color_custom" action="disable"/>
						<event name="selendok" target="bg_color_custom" action="disable"/>
					</events>
				</item>
				<item id="pink_dpink" label="pink-crimson">
					<events>
						<event name="selendok" target="lab_border_color_custom" action="disable"/>
						<event name="selendok" target="border_color_custom" action="disable"/>
						<event name="selendok" target="lab_bg_color_custom" action="disable"/>
						<event name="selendok" target="bg_color_custom" action="disable"/>
					</events>
				</item>
				<item id="lmag_mag" label="lightmagenta-magenta">
					<events>
						<event name="selendok" target="lab_border_color_custom" action="disable"/>
						<event name="selendok" target="border_color_custom" action="disable"/>
						<event name="selendok" target="lab_bg_color_custom" action="disable"/>
						<event name="selendok" target="bg_color_custom" action="disable"/>
					</events>
				</item>
				<item id="linen_brown" label="linen-brown">
					<events>
						<event name="selendok" target="lab_border_color_custom" action="disable"/>
						<event name="selendok" target="border_color_custom" action="disable"/>
						<event name="selendok" target="lab_bg_color_custom" action="disable"/>
						<event name="selendok" target="bg_color_custom" action="disable"/>
					</events>
				</item>
				<item id="llawn_lawn" label="lightlawngreen-green">
					<events>
						<event name="selendok" target="lab_border_color_custom" action="disable"/>
						<event name="selendok" target="border_color_custom" action="disable"/>
						<event name="selendok" target="lab_bg_color_custom" action="disable"/>
						<event name="selendok" target="bg_color_custom" action="disable"/>
					</events>
				</item>
				<item id="lgreen_green" label="lightgreen-green">
					<events>
						<event name="selendok" target="lab_border_color_custom" action="disable"/>
						<event name="selendok" target="border_color_custom" action="disable"/>
						<event name="selendok" target="lab_bg_color_custom" action="disable"/>
						<event name="selendok" target="bg_color_custom" action="disable"/>
					</events>
				</item>
				<item id="khaki_olive" label="khaki-olive">
					<events>
						<event name="selendok" target="lab_border_color_custom" action="disable"/>
						<event name="selendok" target="border_color_custom" action="disable"/>
						<event name="selendok" target="lab_bg_color_custom" action="disable"/>
						<event name="selendok" target="bg_color_custom" action="disable"/>
					</events>
				</item>
				<item id="lcyan_cyan" label="lightcyan-darkcyan">
					<events>
						<event name="selendok" target="lab_border_color_custom" action="disable"/>
						<event name="selendok" target="border_color_custom" action="disable"/>
						<event name="selendok" target="lab_bg_color_custom" action="disable"/>
						<event name="selendok" target="bg_color_custom" action="disable"/>
					</events>
				</item>
				<item id="lcyan_turq" label="lightcyan-turquoise">
					<events>
						<event name="selendok" target="lab_border_color_custom" action="disable"/>
						<event name="selendok" target="border_color_custom" action="disable"/>
						<event name="selendok" target="lab_bg_color_custom" action="disable"/>
						<event name="selendok" target="bg_color_custom" action="disable"/>
					</events>
				</item>
				<item id="lblue_blue" label="lightcyan-cyan">
					<events>
						<event name="selendok" target="lab_border_color_custom" action="disable"/>
						<event name="selendok" target="border_color_custom" action="disable"/>
						<event name="selendok" target="lab_bg_color_custom" action="disable"/>
						<event name="selendok" target="bg_color_custom" action="disable"/>
					</events>
				</item>
				<item id="dblue_blue" label="lightblue-blue">
					<events>
						<event name="selendok" target="lab_border_color_custom" action="disable"/>
						<event name="selendok" target="border_color_custom" action="disable"/>
						<event name="selendok" target="lab_bg_color_custom" action="disable"/>
						<event name="selendok" target="bg_color_custom" action="disable"/>
					</events>
				</item>
				<item id="lviolet_violet" label="lightviolet-violet">
					<events>
						<event name="selendok" target="lab_border_color_custom" action="disable"/>
						<event name="selendok" target="border_color_custom" action="disable"/>
						<event name="selendok" target="lab_bg_color_custom" action="disable"/>
						<event name="selendok" target="bg_color_custom" action="disable"/>
					</events>
				</item>
				<item id="lblue_grey" label="lightblue-grey">
					<events>
						<event name="selendok" target="lab_border_color_custom" action="disable"/>
						<event name="selendok" target="border_color_custom" action="disable"/>
						<event name="selendok" target="lab_bg_color_custom" action="disable"/>
						<event name="selendok" target="bg_color_custom" action="disable"/>
					</events>
				</item>
				<item id="lgrey_grey" label="lightgrey-grey">
					<events>
						<event name="selendok" target="lab_border_color_custom" action="disable"/>
						<event name="selendok" target="border_color_custom" action="disable"/>
						<event name="selendok" target="lab_bg_color_custom" action="disable"/>
						<event name="selendok" target="bg_color_custom" action="disable"/>
					</events>
				</item>
				<item id="white_grey" label="white-grey">
					<events>
						<event name="selendok" target="lab_border_color_custom" action="disable"/>
						<event name="selendok" target="border_color_custom" action="disable"/>
						<event name="selendok" target="lab_bg_color_custom" action="disable"/>
						<event name="selendok" target="bg_color_custom" action="disable"/>
					</events>
				</item>
				<item id="custom" label="Custom">
					<events>
						<event name="selend" target="lab_border_color_custom" action="disable"/>
						<event name="selend" target="border_color_custom" action="disable"/>
						<event name="selend" target="lab_bg_color_custom" action="disable"/>
						<event name="selend" target="bg_color_custom" action="disable"/>
						<event name="selendok" target="lab_border_color_custom" action="enable"/>
						<event name="selendok" target="border_color_custom" action="enable"/>
						<event name="selendok" target="lab_bg_color_custom" action="enable"/>
						<event name="selendok" target="bg_color_custom" action="enable"/>
					</events>
				</item>
			</items>
		</param>
		<param type="label" id="lab_border_color_custom" text="Border color:" def="" x="10" y="58" w="100" h="13"/>
		<param type="color" id="border_color_custom" text="" def="#993333" x="110" y="57" w="48" h="13"/>
		<param type="label" id="lab_bg_color_custom" text="Fill color:" def="" x="10" y="74" w="100" h="13"/>
		<param type="color" id="bg_color_custom" text="" def="#FFFFFF" x="110" y="73" w="48" h="13"/>
		<param type="label" id="lab_arrow" text="Arrow:" def="" x="10" y="90" w="100" h="13"/>
		<param type="select" id="arrow" text="" def="bl" x="110" y="89" w="120" h="13">
			<items>
				<item id="no" label="No arrow"/>
				<item id="tl" label="Top left"/>
				<item id="tc" label="Top center"/>
				<item id="tr" label="Top right"/>
				<item id="rt" label="Right top"/>
				<item id="rm" label="Right middle"/>
				<item id="rb" label="Right bottom"/>
				<item id="br" label="Bottom right"/>
				<item id="bc" label="Bottom center"/>
				<item id="bl" label="Bottom left"/>
				<item id="lb" label="Left bottom"/>
				<item id="lm" label="Left middle"/>
				<item id="lt" label="Left top"/>
			</items>
		</param>
		<param type="check" id="shadow" text="Display shadow" def="no" x="10" y="106" w="180" h="13">
			<events>
				<event name="check" target="lab_shadow_strength" action="enable"/>
				<event name="check" target="shadow_strength" action="enable"/>
				<event name="uncheck" target="lab_shadow_strength" action="disable"/>
				<event name="uncheck" target="shadow_strength" action="disable"/>
			</events>
		</param>
		<param type="label" id="lab_shadow_strength" text="Shadow strength:" def="" x="10" y="122" w="100" h="13"/>
		<param type="select" id="shadow_strength" text="" def="normal" x="110" y="121" w="120" h="13">
			<items>
				<item id="extralight" label="Lightest"/>
				<item id="light" label="Light"/>
				<item id="normal" label="Normal"/>
				<item id="dark" label="Dark"/>
				<item id="extradark" label="Darkest"/>
			</items>
		</param>
	</page>
	<methods>
		<method name="Constructor" label="_Constructor" access="private">
			<params>
			</params>
			<body>
				<![CDATA[function Constructor(argobj)
			{
				if(argobj.pid==null) return false;
				var oCurObj = document.getElementById(argobj.pid);
				if(oCurObj==null) return false;
				if(g_aParams[argobj.pid]==null)
				{
					g_aParams[argobj.pid] = g_oParams.selectSingleNode("./param[@objectid='" + argobj.pid + "']");
					if(g_aParams[argobj.pid]==null) return false;
				}
				if(!argobj.deferred)
				{
					var oObject = g_oSlides.selectSingleNode("//object[@id='" + argobj.pid + "']");
					if(oObject==null) return false;
					switch(oObject.getAttribute("display"))
					{
						case "none":
						{
							AddEvtHandler("EVENT_OBJECT_ONLOAD", "005_balloon", argobj.pid);
							return false;
						}
						case "time":
						case "frame":
						case "slide":
						{
							var sBegin = oObject.getAttribute("begin");
							if(sBegin!=null && sBegin!="0")
							{
								AddEvtHandler("EVENT_OBJECT_ONLOAD", "005_balloon", argobj.pid);
								return false;
							}
							break;
						}
					}
				}
				var sArrow = g_aParams[argobj.pid].selectSingleNode("arrow").text;
				var sPadding = g_aParams[argobj.pid].selectSingleNode("balloon_margin").text;
				var iPadding = parseInt(sPadding, 10);
				if(isNaN(iPadding)) iPadding = 12; 
				var oVMLDiv = document.getElementById(argobj.pid + "_vml_div");
				var oW3CDiv = document.getElementById(argobj.pid + "_w3c_div");
				if(oVMLDiv==null || oW3CDiv==null) return false;
				var oTxt = document.getElementById(g_isMSIE ? argobj.pid + "_txt" : argobj.pid + "_txt_w3c");
				if(oTxt==null) return false;
				var aPs = oTxt.getElementsByTagName("p");
				if(aPs[0]!=null) aPs[aPs.length-1].style.marginBottom = "0px";
				var iTxtH = oTxt.offsetHeight;
				var iTxtW = oTxt.offsetWidth;
				var iH;
				var iW;
				var oShape;
				var iTopS;
				var iTopM;
				var iTopL;
				var oSmall;
				var oMedium;
				var oLarge;
				var iSmallH = parseInt(oVMLDiv.getAttribute("smallh"), 10);
				var iMediumH = parseInt(oVMLDiv.getAttribute("mediumh"), 10);
				var iLargeH = parseInt(oVMLDiv.getAttribute("largeh"), 10);
				if(isNaN(iSmallH)) iSmallH = 11;
				if(isNaN(iMediumH)) iMediumH = 15;
				if(isNaN(iLargeH)) iLargeH = 17;
				var iOffsetMediumLT = 10;
				var iOffsetMediumTL = 8;
				var iOffsetMediumTC = 9;
				var iOffsetLargeLT = 15;
				var iOffsetLargeTL = 22;
				var iOffsetLargeTC = 24;
				var iArrowH = 45;
				if(g_isMSIE)
				{
					oW3CDiv.style.display = "none";
					oW3CDiv.innerHTML = ".";
					oShape = document.getElementById(argobj.pid + "_shape");
					if(oShape==null) return false;
					iH = iTxtH + 2*iPadding + 20;
					iW = parseInt(oShape.style.width, 10);
					oShape.style.height = iH + "px";
					RedrawVMLRoundRectShape(oShape, iW, iH, 10, 1000);
					oSmall = document.getElementById(argobj.pid + "_shape_small");
					oMedium = document.getElementById(argobj.pid + "_shape_medium");
					oLarge = document.getElementById(argobj.pid + "_shape_large");
					if(oSmall==null || oMedium==null || oLarge==null) return false;
					switch(sArrow)
					{
						case "lm":
						case "rm":
						{
							iTopS = Math.round(0.5*(iH - iSmallH));
							iTopM = Math.round(0.5*(iH - iMediumH));
							iTopL = Math.round(0.5*(iH - iLargeH));
							oSmall.style.top = iTopS + "px";
							oMedium.style.top = iTopM + "px";
							oLarge.style.top = iTopL + "px";
							break;
						}
						case "lb":
						case "rb":
						{
							iTopS = iH - iSmallH;
							iTopM = iH - iMediumH - iOffsetMediumLT;
							iTopL = iH - iLargeH - iOffsetLargeLT;
							oSmall.style.top = iTopS + "px";
							oMedium.style.top = iTopM + "px";
							oLarge.style.top = iTopL + "px";
							break;
						}
						case "bl":
						case "br":
						{
							iH = iH + iArrowH;
							iTopS = iH - iSmallH;
							iTopM = iH - iMediumH - iOffsetMediumTL;
							iTopL = iH - iLargeH - iOffsetLargeTL;
							oSmall.style.top = iTopS + "px";
							oMedium.style.top = iTopM + "px";
							oLarge.style.top = iTopL + "px";
							break;
						}
						case "bc":
						{
							iH = iH + iArrowH;
							iTopS = iH - iSmallH;
							iTopM = iH - iMediumH - iOffsetMediumTC;
							iTopL = iH - iLargeH - iOffsetLargeTC;
							oSmall.style.top = iTopS + "px";
							oMedium.style.top = iTopM + "px";
							oLarge.style.top = iTopL + "px";
							break;
						}
					}
				}
				else
				{
					oVMLDiv.style.display = "none";
					oVMLDiv.innerHTML = ".";
					iH = iTxtH + 2*iPadding + 16;
					oShape = document.getElementById(argobj.pid + "_w3c_shape");
					if(oShape==null) return false;
					oShape.style.height = iH + "px";
					oSmall = document.getElementById(argobj.pid + "_bubble_small");
					oMedium = document.getElementById(argobj.pid + "_bubble_medium");
					oLarge = document.getElementById(argobj.pid + "_bubble_large");
					if(oSmall==null || oMedium==null || oLarge==null) return false;
					switch(sArrow)
					{
						case "lm":
						case "rm":
						{
							iTopS = Math.round(0.5*(iH - iSmallH));
							iTopM = Math.round(0.5*(iH - iMediumH));
							iTopL = Math.round(0.5*(iH - iLargeH));
							oSmall.style.top = iTopS + "px";
							oMedium.style.top = iTopM + "px";
							oLarge.style.top = iTopL + "px";
							break;
						}
						case "lb":
						case "rb":
						{
							iTopS = iH - iSmallH;
							iTopM = iH - iMediumH - iOffsetMediumLT;
							iTopL = iH - iLargeH - iOffsetLargeLT;
							oSmall.style.top = iTopS + "px";
							oMedium.style.top = iTopM + "px";
							oLarge.style.top = iTopL + "px";
							break;
						}
						case "bl":
						case "br":
						{
							iH = iH + iArrowH;
							iTopS = iH - iSmallH;
							iTopM = iH - iMediumH - iOffsetMediumTL;
							iTopL = iH - iLargeH - iOffsetLargeTL;
							oSmall.style.top = iTopS + "px";
							oMedium.style.top = iTopM + "px";
							oLarge.style.top = iTopL + "px";
							break;
						}
						case "bc":
						{
							iH = iH + iArrowH;
							iTopS = iH - iSmallH;
							iTopM = iH - iMediumH - iOffsetMediumTC;
							iTopL = iH - iLargeH - iOffsetLargeTC;
							oSmall.style.top = iTopS + "px";
							oMedium.style.top = iTopM + "px";
							oLarge.style.top = iTopL + "px";
							break;
						}
					}
				}
				oCurObj.setAttribute("after--init", "1");
				return true;
			}]]>
			</body>
		</method>
		<method name="HandleEvt" label="_HandleEvt" access="private">
			<params>
			</params>
			<body>
				<![CDATA[function HandleEvt(oEvtHandler, oArg)
			{
				var argobj = { pid: oEvtHandler.sTargetId };
				var oCurObj = document.getElementById(argobj.pid);
				if(oCurObj==null) return false;
				switch (oEvtHandler.sEvt)
				{
					case "EVENT_OBJECT_ONLOAD":
					{
						if(oCurObj.getAttribute("after--init")=="1") return true;
						argobj.deferred = true;
						CallMethod("005_balloon", "Constructor", argobj);
						break;
					}
				}
				return true;
			}]]>
			</body>
		</method>
	</methods>
</params>
